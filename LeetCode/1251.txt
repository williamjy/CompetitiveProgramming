# Write your MySQL query statement below
SELECT P.product_id, ROUND(SUM(U.units * P.price) / SUM(U.units), 2) AS average_price FROM Prices P JOIN UnitsSold U ON P.product_id = U.product_id AND DATEDIFF(U.purchase_date, P.start_date) >= 0 AND DATEDIFF(P.end_date, U.purchase_date) >= 0 GROUP BY P.product_id;